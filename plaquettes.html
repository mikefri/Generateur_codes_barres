<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GenCodeBarre v2.3 </title>
    <meta name="theme-color" content="#0f172a">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.6/dist/JsBarcode.all.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode/1.5.1/qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <link rel="stylesheet" href="plaquettes.css">
    
</head>

<body>

    <aside class="sidebar">
        <div class="sidebar-header">
            <div class="app-title">GenCodeBarres<span style="font-size: 0.7em; opacity: 0.6; font-weight: normal; margin-left: 5px;">v2.3</span></div>
        </div>

        <div class="sidebar-content">

            <div class="tabs-nav">
                <a href="https://mikefri.github.io/GenCodeBarre/" class="tab-btn" id="btn-tab-tools">√âditeur</a>
                <button class="tab-btn active" id="btn-tab-tools" data-target="tab-tools">Planches</button>
            </div>


            <div class="control-group">
                <label>1. Source de Donn√©es (Excel)</label>
                <label class="drop-zone" id="dropZone">
                    <div style="font-size: 1.5rem; margin-bottom: 5px;">üìÇ Import .xlsx</div>
                    <div style="font-size: 0.75rem; opacity: 0.6;">Colonne A uniquement</div>
                    <input type="file" id="excelInput" class="hidden-input" accept=".xlsx, .xls" style="display:none">
                </label>

                <div id="importStatus" class="status-card">
                    <div style="color: #fff; font-weight: 600; font-size: 0.8rem;">Import OK</div>
                    <div id="importCount" style="color: #a7f3d0; font-size: 0.75rem;"></div>
                </div>

                <button id="clearDataBtn" class="action-btn btn-danger" style="display:none;">Effacer les donn√©es</button>
            </div>

            <div class="divider"></div>

            <div class="control-group">
                <label>2. Type de Code</label>
                <select id="codeType">
                    <option value="CODE128">Code 128</option>
                    <option value="EAN13">EAN-13</option>
                    <option value="QRCODE">QR Code</option>
                </select>
            </div>

            <div class="control-group">
                <label>3. Configuration Planches</label>

                <select id="gridPresetSelect" style="margin-bottom: 10px;">
                    <option value="" selected disabled>S√©lectionner un Mod√®le pr√©d√©fini...</option>
                </select>
                <div class="grid-settings">
                    <div class="grid-row">
                        <div class="grid-col">
                            <label>Marge Haut (mm)</label>
                            <input type="number" id="marginTop" value="4.5" step="0.5">
                        </div>
                        <div class="grid-col">
                            <label>Marge G (mm)</label>
                            <input type="number" id="marginLeft" value="5" step="0.5">
                        </div>
                    </div>
                    <div class="grid-row">
                        <div class="grid-col">
                            <label>Colonnes</label>
                            <input type="number" id="nbCols" value="3">
                        </div>
                        <div class="grid-col">
                            <label>Lignes</label>
                            <input type="number" id="nbRows" value="8">
                        </div>
                    </div>
                    <div class="grid-row">
                        <div class="grid-col">
                            <label>H. √âtiquette (mm)</label>
                            <input type="number" id="rowHeight" value="36">
                        </div>
                        <div class="grid-col">
                            <label>√âchelle Code</label>
                            <input type="number" id="codeScale" value="1" step="0.1" min="0.5" max="3">
                        </div>
                    </div>
                </div>
            </div>

<div class="control-group">
    <label>4. Option Fl√®che lat√©rale</label>
    <select id="arrowOption" style="margin-bottom: 10px;">
        <option value="none">Aucune</option>
        <option value="line-up">‚Üë Vers le Haut </option> <option value="line-down">‚Üì Vers le Bas </option> </select>
</div>
            </div>

        <div class="sidebar-footer">
            <button class="action-btn btn-print" onclick="window.print()">Imprimer toutes les Planches</button>
            <button class="action-btn btn-download" id="downloadBtn">T√©l√©charger le PDF</button>
        </div>
    </aside>

    <main class="main-content">

    <button id="helpButton" class="action-btn help-btn" title="Aide et informations">
    <i class="fas fa-circle-info"></i> </button>
        
        
        <div class="toolbar-preview">
            <span>Zoom Aper√ßu</span>
            <input type="range" id="zoomSlider" min="0.4" max="1.5" step="0.1" value="0.7">
        </div>

        <div class="preview-scroll-wrapper">
            <div class="sheet-transform-layer" id="sheetLayer" style="transform: scale(0.7);">
                <div id="pageSheet" class="sheet">
                    <div id="gridContainer" class="grid-container">
                        <div class="barcode-cell" style="color:#aaa; font-size:0.8rem;">
                            (Zone d'aper√ßu - Importez un fichier)
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script src="plaquettes.js" defer></script>


    <div id="helpModal" class="modal-overlay">
  <div class="modal-content">
    <div class="modal-header">
      <h3>‚ùì Guide d'utilisation GenCodeBarre v2.3</h3>
      <button class="close-btn" id="closeModalBtn">&times;</button>
    </div>
    <div class="modal-body">

      
      <h4>üìÇ Onglet Planches</h4>
      <p>Cet onglet vous permet d'importer une liste de codes depuis un fichier **Excel (.xlsx)** afin de g√©n√©rer une ou plusieurs planche(s) compl√®te(s) en une seule fois.</p>
<ul>
    <li>Source de Donn√©es (Excel) : Assurez-vous que tous vos codes sont list√©s dans la colonne A du fichier Excel.</li>
    <li>Type de Code : Choisissez le type de code (Code 128 pour la plupart des usages, EAN-13 pour les produits, QR Code pour les liens/infos).</li>
    <li>Configuration Grille : S√©lectionnez le type de planche que vous souhaitez.</li>
    <li>Option Fl√®che lat√©rale : Vous avez la possibilit√© d'ajouter une fl√®che d'orientation sur la partie gauche du code-barres.</li>
</ul>
          
      </ul>
    </div>
  </div>
</div>

    
</body>

</html>
