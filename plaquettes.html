<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GenCodeBarres V2.3 - G√©n√©rateur d'√âtiquettes Multipage</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="plaquettes.css"> 
</head>
<body>

    <button id="helpButton" class="help-btn" title="Aide et Instructions">?</button>

    <div class="sidebar">
        <div class="sidebar-header">
            <h1 class="app-title">GenCodeBarres <span style="font-size: 0.7em; opacity: 0.6;">v2.3</span></h1>
        </div>

        <div class="sidebar-content">
            
            <div class="tabs-nav">
                <button class="tab-btn" onclick="window.location.href='https://mikefri.github.io/GenCodeBarre/'">Cr√©ation</button> 
                <button class="tab-btn active" id="btn-tab-planches" data-target="tab-tools">Planches</button>
            </div>


            <div class="control-group">
                <label>1. Source de Donn√©es</label>
                
                <textarea id="manualInput" placeholder="Saisir vos codes ici (un code par ligne)..." rows="5"></textarea>

                <label style="text-align: center; margin: 10px 0; font-style: italic; opacity: 0.8;">OU</label>

                <label class="drop-zone" id="dropZone">
                    <div style="font-size: 1.5rem; margin-bottom: 5px;">üìÇ Import .xlsx</div>
                    <div style="font-size: 0.75rem; opacity: 0.6;">Colonne A uniquement</div>
                    <input type="file" id="excelInput" class="hidden-input" accept=".xlsx, .xls" style="display:none">
                </label>

                <div id="importStatus" class="status-card">
                    <div style="color: #fff; font-weight: 600; font-size: 0.8rem;">Donn√©es charg√©es</div>
                    <div id="importCount" style="color: #a7f3d0; font-size: 0.75rem;"></div>
                </div>

                <button id="clearDataBtn" class="action-btn btn-danger" style="display:none;">Effacer les donn√©es</button>
            </div>

            <hr class="divider">

            <div class="control-group">
                <label>2. Configuration du Code</label>
                <div class="grid-settings">
                    <div class="grid-row">
                        <div class="grid-col">
                            <label for="codeType">Type de Code</label>
                            <select id="codeType">
                                <option value="CODE128">Code 128</option>
                                <option value="EAN13">EAN-13</option>
                                <option value="QRCODE">QR Code</option>
                            </select>
                        </div>
                        <div class="grid-col">
                            <label for="codeScale">√âchelle / Taille</label>
                            <input type="number" id="codeScale" min="0.5" max="5" step="0.1" value="1.5">
                        </div>
                    </div>
                    <div class="grid-col">
                        <label for="arrowOption">Ajouter une fl√®che (Optionnel)</label>
                        <select id="arrowOption">
                            <option value="none">Aucune</option>
                            <option value="line-up">Fl√®che Haut</option>
                            <option value="line-down">Fl√®che Bas</option>
                        </select>
                    </div>
                </div>
            </div>

            <hr class="divider">

            <div class="control-group">
                <label>3. Configuration de la Planche (mm)</label>
                <div class="grid-settings">
                    
                    <div class="grid-col">
                        <label for="gridPresetSelect">Presets (Mod√®les Courants)</label>
                        <select id="gridPresetSelect">
                            <option value="">-- Personnalis√© --</option>
                            </select>
                    </div>

                    <div class="grid-row">
                        <div class="grid-col">
                            <label for="marginTop">Marge Haut (mm)</label>
                            <input type="number" id="marginTop" min="0" max="100" step="0.5" value="4.5">
                        </div>
                        <div class="grid-col">
                            <label for="marginLeft">Marge C√¥t√© (mm)</label>
                            <input type="number" id="marginLeft" min="0" max="100" step="0.5" value="5">
                        </div>
                    </div>
                    <div class="grid-row">
                        <div class="grid-col">
                            <label for="nbCols">Nb. Cols</label>
                            <input type="number" id="nbCols" min="1" max="10" step="1" value="3">
                        </div>
                        <div class="grid-col">
                            <label for="nbRows">Nb. Lignes</label>
                            <input type="number" id="nbRows" min="1" max="50" step="1" value="8">
                        </div>
                    </div>
                    <div class="grid-row">
                        <div class="grid-col">
                            <label for="rowHeight">Hauteur Ligne (mm)</label>
                            <input type="number" id="rowHeight" min="10" max="250" step="0.5" value="36">
                        </div>
                    </div>

                </div>
            </div>

        </div>

        <div class="sidebar-footer">
            <button id="downloadBtn" class="action-btn btn-print">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-text"><path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z"/><path d="M14 2v4a2 2 0 0 0 2 2h4"/><path d="M10 9H8"/><path d="M16 13H8"/><path d="M16 17H8"/></svg>
                T√©l√©charger le PDF
            </button>
        </div>
    </div>
    
    <main class="main-content">

        <div class="toolbar-preview">
            <span>Zoom Aper√ßu</span>
            <input type="range" id="zoomSlider" min="0.4" max="1.5" step="0.05" value="0.70">
            <span id="zoomValue">70%</span> 
        </div>

        <div class="preview-scroll-wrapper">
            <div id="sheetLayer" class="sheet-transform-layer">
                <div id="pageSheet" class="sheet">
                    <div id="gridContainer" class="grid-container">
                        </div>
                </div>
            </div>
        </div>
    </main>

    <div id="helpModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>‚ùì Instructions & Aide</h3>
                <button id="closeModalBtn" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <h4>1. Source de Donn√©es</h4>
                <ul>
                    <li>**Saisie Manuelle :** Entrez simplement vos codes (num√©riques ou alphanum√©riques) un par ligne dans la zone de texte.</li>
                    <li>**Import Excel :** Cliquez ou glissez-d√©posez un fichier `.xlsx` ou `.xls`. Seule la **Colonne A** (la premi√®re colonne) sera lue. Les codes doivent √™tre pr√©sents dans cette colonne, sans en-t√™te.</li>
                    <li>*Priorit√© :* Si un fichier Excel est charg√©, la saisie manuelle est d√©sactiv√©e. Cliquez sur "Effacer les donn√©es" pour r√©activer la saisie manuelle.</li>
                </ul>

                <h4>2. Configuration du Code</h4>
                <ul>
                    <li>**Type :** Choisissez entre Code 128, EAN-13, ou QR Code.
                        <ul>
                            <li>*EAN-13 :* Si vous entrez un code √† 12 chiffres, le 13√®me chiffre (cl√© de contr√¥le) est calcul√© automatiquement.</li>
                        </ul>
                    </li>
                    <li>**√âchelle / Taille :** Ajustez la densit√© du code (largeur des barres pour les codes-barres, taille du QR Code).</li>
                    <li>**Fl√®che :** Pour des applications sp√©cifiques (ex: orientation de pose), vous pouvez ajouter une fl√®che de direction.</li>
                </ul>
                
                <h4>3. Configuration de la Planche</h4>
                <ul>
                    <li>**Presets :** Utilisez les mod√®les pr√©d√©finis (par exemple, des formats Avery ou standards). S√©lectionner un preset met √† jour toutes les marges et dimensions.</li>
                    <li>**Dimensions (mm) :** Ajustez pr√©cis√©ment les marges et les dimensions des √©tiquettes (nombre de colonnes, lignes et hauteur de ligne) en millim√®tres.</li>
                </ul>

                <h4>Aper√ßu et Export</h4>
                <ul>
                    <li>L'aper√ßu montre exactement ce qui sera imprim√©. Utilisez le slider en haut pour zoomer.</li>
                    <li>Cliquez sur **T√©l√©charger le PDF** pour g√©n√©rer un document multi-pages pr√™t √† √™tre imprim√©. Chaque page du PDF correspond √† une planche A4.</li>
                </ul>
            </div>
        </div>
    </div>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.6/dist/JsBarcode.all.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.1/build/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="plaquettes.js"></script>
</body>
</html>
